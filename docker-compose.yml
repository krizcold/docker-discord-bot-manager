name: discordbotmanager

services:
  discordbotmanager:
    image: ghcr.io/yundera/nginx-hash-lock:latest
    restart: unless-stopped
    expose:
      - "80"
    user: "root"
    environment:
      AUTH_HASH: $AUTH_HASH
      BACKEND_HOST: "discordbotmanagerapp"
      BACKEND_PORT: "8080"
      LISTEN_PORT: "80"
      ALLOWED_EXTENSIONS: "js,jsx,css,png,ico,svg,jpg,jpeg,gif,woff,woff2,ttf,eot"
      ALLOWED_PATHS: "api"
    depends_on:
      - discordbotmanagerapp
    networks:
      - pcs
    privileged: true
    cap_add:
      - SYS_ADMIN
      - NET_ADMIN

  discordbotmanagerapp:
    image: ghcr.io/krizcold/docker-discord-bot-manager:latest
    container_name: discordbotmanagerapp
    restart: unless-stopped
    user: "root"
    environment:
      NODE_ENV: production
      DATA_DIR: /data
      PORT: 8080
      API_HASH: $API_HASH
    volumes:
      - type: bind
        source: /var/run/docker.sock
        target: /var/run/docker.sock
      - type: bind
        source: /DATA/AppData/discordbotmanager/data
        target: /data
    networks:
      - pcs
    expose:
      - 8080

    privileged: true
    cap_add:
      - SYS_ADMIN
      - NET_ADMIN

    cpu_shares: 50
    deploy:
      resources:
        limits:
          memory: 512M

    x-casaos:
      volumes:
        - container: /var/run/docker.sock
          description:
            en_us: Docker socket for container management.
        - container: /data
          description:
            en_us: Persistent data directory for bot configurations and registry.

networks:
  pcs:
    external: true

x-casaos:
  architectures:
    - amd64
    - arm64
  main: discordbotmanager
  author: kriz_cold
  developer: kriz_cold
  icon: https://cdn.statically.io/gh/krizcold/AppStore/main/Apps/Discord-Bot-Manager/icon.png
  tagline:
    en_us: "Manage multiple Discord bots from GitHub repositories"
  category: Utilities
  description:
    en_us: "A Docker-based platform for managing Discord bots. Import bots from GitHub, configure environment variables, and manage deployments with automatic updates."
  title:
    en_us: "Discord Bot Manager"
  store_app_id: discordbotmanager
  is_uncontrolled: false
  index: /?hash=$AUTH_HASH
  port_map: "80"
  webui_port: 80
